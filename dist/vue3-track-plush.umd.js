var e,t;e=this,t=function(e){"use strict";var t=function(e){var t="".concat(e.baseURL?e.baseURL:"").concat(e.url?e.url:""),n=new Blob([JSON.stringify(e.data||{})],{type:"application/json"});navigator.sendBeacon(t,n)},n=function(){function e(e){var t=this;this.handleClickEvent=function(){t.handleSendTrack("object"==typeof t.trackParams?t.trackParams:{buttonName:t.trackParams})},this.trackConfig=e}return e.getInstance=function(t){return this.instance||(this.instance=new e(t)),this.instance},e.prototype.handleAddClickEvent=function(e){var t=e.el,n=e.trackParams;this.trackParams=n,t.addEventListener("click",this.handleClickEvent)},e.prototype.handleRemoveClickEvent=function(e){e.removeEventListener("click",this.handleClickEvent)},e.prototype.handleSendTrack=function(e){var n=Object.assign({userAgent:navigator.userAgent,pageUrl:window.location.href,projectName:this.trackConfig.projectName,actionType:"点击事件"},e);t({baseURL:this.trackConfig.baseURL,url:this.trackConfig.url,data:n})},e}(),a=function(){function e(e){this.trackConfig=e}return e.getInstance=function(t){return this.instance||(this.instance=new e(t)),this.instance},e.prototype.handleBrowseEvent=function(e){this.handleSendTrack("object"==typeof e?e:{pageName:e})},e.prototype.handleSendTrack=function(e){var n=Object.assign({userAgent:navigator.userAgent,pageUrl:window.location.href,projectName:this.trackConfig.projectName,actionType:"浏览事件"},e);t({baseURL:this.trackConfig.baseURL,url:this.trackConfig.url,data:n})},e}(),c=function(){function e(){}return e.install=function(t,c){e.prototype.clickInstance=n.getInstance(c),e.prototype.browserInstance=a.getInstance(c),t.directive("track",{mounted:function(t,n){var a=n.arg,c=n.value;switch(a){case"click":e.prototype.clickInstance.handleAddClickEvent({el:t,trackParams:c});break;case"browse":e.prototype.browserInstance.handleBrowseEvent(c)}},updated:function(t,n){var a=n.arg,c=n.value,r=n.oldValue;if(JSON.stringify(c)!==JSON.stringify(r))switch(a){case"click":e.prototype.clickInstance.handleRemoveClickEvent(t),e.prototype.clickInstance.handleAddClickEvent({el:t,trackParams:c});break;case"browse":e.prototype.browserInstance.handleBrowseEvent(c)}},unmounted:function(t,n){"click"===n.arg&&e.prototype.clickInstance.handleRemoveClickEvent(t)}})},e}();e.Browse=a,e.Click=n,e.browseEvent=function(e){var t=new a(e),n={};Object.keys(e).forEach((function(t){if(!["baseURL","url","projectName"].includes(t)){var a=e[t];n[t]=a}})),t.handleSendTrack(n)},e.clickEvent=function(e){var t=new n(e),a={};Object.keys(e).forEach((function(t){if(!["baseURL","url","projectName"].includes(t)){var n=e[t];a[t]=n}})),t.handleSendTrack(a)},e.default=c,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Vue3TrackPlush={});
